  <form [formGroup]="checkoutForm" (ngSubmit)="onSubmit()" novalidate>
    <fieldset class="border p-3">
      <legend class="w-auto">{{ 'checkout.contactData' | translate }}</legend>
      <div class="form-row">
        <div class="form-group">
          <label for="nomeCompleto">{{ 'checkout.fullName' | translate }}</label>
            <input
            type="text"
            id="nomeCompleto"
            class="form-control"
            [ngClass]="{'is-invalid': control('nomeCompleto').touched && control('nomeCompleto').invalid}"
            formControlName="nomeCompleto"
            />
          <div class="invalid-feedback">
            @if(control('nomeCompleto').touched && control('nomeCompleto').hasError('required')) { <div>{{ 'checkout.fullNameRequired' | translate }}</div> }
            @if(control('nomeCompleto').touched && control('nomeCompleto').hasError('minlength')) { <div>{{ 'checkout.fullNameMinlength' | translate }}</div> }
          </div>
        </div>

        <div class="form-group">
          <label for="email">{{ 'checkout.email' | translate }}</label>
          <input
            type="email"
            id="email"
            class="form-control"
            [ngClass]="{'is-invalid': control('email').touched && control('email').invalid}"
            formControlName="email"
          />
          <div class="invalid-feedback">
            @if(control('email').touched && control('email').hasError('required')) { <div>{{ 'checkout.emailRequired' | translate }}</div> }
            @if(control('email').touched && control('email').hasError('email')) { <div>{{ 'checkout.emailPattern' | translate }}</div> }
          </div>
        </div>
        <div class="form-group">
          <label for="endereco">{{ 'checkout.address' | translate }}</label>
          <input
            type="text"
            id="endereco"
            class="form-control"
            [ngClass]="{'is-invalid': control('endereco').touched && control('endereco').invalid}"
            formControlName="endereco"
          />
          <div class="invalid-feedback">
            @if(control('endereco').touched && control('endereco').hasError('required')) { <div>{{ 'checkout.addressRequired' | translate }}</div> }
            @if(control('endereco').touched && control('endereco').hasError('minlength')) { <div>{{ 'checkout.addressMinlength' | translate }}</div> }
          </div>
        </div>
      </div>
    </fieldset>

    <fieldset class="border p-3 mt-4">
      <legend class="w-auto">{{ 'checkout.paymentField' | translate }}</legend>

      <div class="form-row">
        <div class="form-group">
          <label for="nomeNoCartao">{{ 'checkout.paymentName' | translate }}</label>
          <input
            type="text"
            id="nomeNoCartao"
            class="form-control"
            [ngClass]="{'is-invalid': control('nomeNoCartao').touched && control('nomeNoCartao').invalid}"
            formControlName="nomeNoCartao"
          />
          <div class="invalid-feedback">
            @if(control('nomeNoCartao').touched && control('nomeNoCartao').hasError('required')) { <div>{{ 'checkout.paymentNameRequired' | translate }}</div> }
            @if(control('nomeNoCartao').touched && control('nomeNoCartao').hasError('minlength')) { <div>{{ 'checkout.paymentNameMinlength' | translate }}</div> }
          </div>
        </div>

        <div class="form-group">
          <label for="numeroCartao">{{ 'checkout.paymentNumber' | translate }}</label>
          <input
            type="text"
            id="numeroCartao"
            inputmode="numeric"
            class="form-control"
            [ngClass]="{'is-invalid': control('numeroCartao').touched && control('numeroCartao').invalid}"
            formControlName="numeroCartao"
          />
          <div class="invalid-feedback">
            @if(control('numeroCartao').touched && control('numeroCartao').hasError('required')) { <div>{{ 'checkout.paymentNumberRequired' | translate }}</div> }
            @if(control('numeroCartao').touched && (control('numeroCartao').hasError('minlength') || control('numeroCartao').hasError('maxlength'))) { <div>{{ 'checkout.paymentNumberPattern' | translate }}</div> }
            @if(control('numeroCartao').touched && control('numeroCartao').hasError('digitsOnly')) { <div>{{ 'checkout.paymentNumberOnly' | translate }}</div> }
          </div>
        </div>

        <div class="form-group">
          <label for="codigoSeguranca">{{ 'checkout.cvc' | translate }}</label>
          <input
            type="text"
            id="codigoSeguranca"
            inputmode="numeric"
            class="form-control"
            [ngClass]="{'is-invalid': control('codigoSeguranca').touched && control('codigoSeguranca').invalid}"
            formControlName="codigoSeguranca"
          />
          <div class="invalid-feedback">
            @if(control('codigoSeguranca').touched && control('codigoSeguranca').hasError('required')) { <div>{{ 'checkout.cvcRequired' | translate }}</div> }
            @if(control('codigoSeguranca').touched && (control('codigoSeguranca').hasError('minlength') || control('codigoSeguranca').hasError('maxlength'))) { <div>{{ 'checkout.cvcPattern' | translate }}</div> }
            @if(control('codigoSeguranca').touched && control('codigoSeguranca').hasError('digitsOnly')) { <div>{{ 'checkout.cvcOnly' | translate }}</div> }
          </div>
        </div>

        <div class="form-group">
          <label for="validadeMes">{{ 'checkout.expirationMonth' | translate }}</label>
          <input
            type="text"
            id="validadeMes"
            placeholder="MM"
            class="form-control"
            [ngClass]="{'is-invalid': control('validadeMes').touched && control('validadeMes').invalid}"
            formControlName="validadeMes"
          />
          <div class="invalid-feedback">
            @if(control('validadeMes').touched && control('validadeMes').hasError('required')) { <div>{{ 'checkout.expirationMonthRequired' | translate }}</div> }
            @if(control('validadeMes').touched && control('validadeMes').hasError('pattern')) { <div>{{ 'checkout.expirationMonthPattern' | translate }}</div> }
          </div>
        </div>

        <div class="form-group">
          <label for="validadeAno">{{ 'checkout.expirationYear' | translate }}</label>
          <input
            type="text"
            id="validadeAno"
            placeholder="AAAA"
            class="form-control"
            [ngClass]="{'is-invalid': control('validadeAno').touched && control('validadeAno').invalid}"
            formControlName="validadeAno"
          />
          <div class="invalid-feedback">
            @if(control('validadeAno').touched && control('validadeAno').hasError('required')) { <div>{{ 'checkout.expirationYearRequired' | translate }}</div> }
            @if(control('validadeAno').touched && control('validadeAno').hasError('pattern')) { <div>{{ 'checkout.expirationYearPattern' | translate }}</div> }
          </div>
        </div>
      </div>
    </fieldset>

    <button type="submit" class="btn btn-primary btn-block mt-3" [disabled]="!checkoutForm.valid || !(cartItems$ | async)?.length">{{ 'checkout.submit' | translate }}</button>

    @if(submittedData()) {
        <div class="alert alert-success mt-3">{{ 'checkout.successMessage' | translate }}</div>
      }
  </form>
